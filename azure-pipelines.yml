trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

steps:
- powershell: .\test.ps1
  workingDirectory: $(build.sourcesDirectory)
  displayName: Running unit tests

- task: PublishCodeCoverageResults@1
  displayName: Publish code coverage results
  inputs:
    summaryFileLocation: coverage.xml

- task: PublishTestResults@2
  displayName: Public tests results
  inputs:
    testResultsFormat: NUnit
    testResultsFiles: output.xml
    failTaskOnFailedTests: true

- publish: $(Build.SourcesDirectory)
  artifact: module